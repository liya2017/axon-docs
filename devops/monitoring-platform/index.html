<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-devops/monitoring-platform">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Monitoring Platform | Axon Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.axonweb3.io//devops/monitoring-platform"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Monitoring Platform | Axon Documentation"><meta data-rh="true" name="description" content="Black box, monitoring system, and observability"><meta data-rh="true" property="og:description" content="Black box, monitoring system, and observability"><link data-rh="true" rel="icon" href="/img/axon.png"><link data-rh="true" rel="canonical" href="https://docs.axonweb3.io//devops/monitoring-platform"><link data-rh="true" rel="alternate" href="https://docs.axonweb3.io//devops/monitoring-platform" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.axonweb3.io//devops/monitoring-platform" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://NN0YKWI8GH-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Axon Documentation" href="/opensearch.xml">
<script src="/js/loadLinks.js"></script><link rel="stylesheet" href="/assets/css/styles.dd3e3b06.css">
<link rel="preload" href="/assets/js/runtime~main.af764483.js" as="script">
<link rel="preload" href="/assets/js/main.efb38284.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/logo_light.png" alt="Axon" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo_dark.png" alt="Axon" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Why Build With Axon</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/category/axon-fundamentals">Axon Fundamentals</a><button aria-label="Toggle the collapsible sidebar category &#x27;Axon Fundamentals&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fundamentals/axon_fundamentals">Axon Fundamentals</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/category/getting-started">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" tabindex="0" href="/category/for-dapp-devs">For DApp Devs</a><button aria-label="Toggle the collapsible sidebar category &#x27;For DApp Devs&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/for-dapp-devs/zero_to_axon_with_axon_cli">Zero to Axon with Axon-CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/for-dapp-devs/send_transactions_on_axon_via_metaMask">Send Transactions On Axon Via MetaMask</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/for-dapp-devs/deploy_dapps">Deploy DApps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/for-dapp-devs/troubleshooting">Troubleshooting</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" tabindex="0" href="/category/for-contributors">For Contributors</a><button aria-label="Toggle the collapsible sidebar category &#x27;For Contributors&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/for-contributor/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/for-contributor/consensus">Consensus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/for-contributor/storage">Storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/for-contributor/executor">Executor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/for-contributor/mempool">Mempool</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/for-contributor/icsc">Image Cell System Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/for-contributor/network">Network</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/category/contracts">Contracts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Contracts&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contract/system_contacts">System Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contract/precompile_contracts">Precompile Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contract/genesis_contracts">Genesis Contracts</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/category/api">API</a><button aria-label="Toggle the collapsible sidebar category &#x27;API&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/api/latest_version">Latest Version</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/category/devops">DevOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/devops/monitoring-platform">Monitoring Platform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/devops/explorer">Explorer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/devops/faucet">Faucet</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/devops"><span itemprop="name">DevOps</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Monitoring Platform</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Monitoring Platform</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="black-box-monitoring-system-and-observability">Black box, monitoring system, and observability<a class="hash-link" href="#black-box-monitoring-system-and-observability" title="Direct link to heading">​</a></h2><p>A distributed system contains multiple physically separate nodes linked together by a network. Such systems are inherently difficult to monitor as they are composed of “block-box” components: nodes from different, even competing providers. In such an environment, how to quickly debug, track service processing time, identify performance bottlenecks, and reasonably evaluate service capacity are the major challenges. Monitoring platform plays a crucial role in system feedback, without which improvement is impossible. </p><p>Axon is built on a peer-to-peer network. It&#x27;s real-time monitoring system is composed of components that collect logs, metrics, and system resource usage data from the nodes and display the information in graphs in Grafana, the data visualization platform. This article aims to give you an overview of the architecture of Axon monitoring system and the key components (II), the deployment of the monitoring platform (III), and how to read these metrics (IV). Sections III and IV include technical details and parameters that will be particularly informative for DevOps; if these technical details are not your focus, feel free to skip.</p><p>Before diving into the technical details, let&#x27;s refresh ourselves about the concept of “observability&quot;. When introduced in response to the black box problems in distributed systems, observability refers to the ability to measure the internal states of a system by examining its outputs. While traditional monitoring and alerting are focusing on system anomalies and failures, observability is about showing the actual behavior of the system itself. For an observable system, the primary concern is the state of the application itself, such as the current throughput and latency, instead of the indirect evidences like the machine or the network where the application is situated. </p><p>Logs, metrics, and traces are seen as three pillars of observability.</p><p><strong>Logs</strong></p><p>Logs are primarily used for recording discrete, time-stamped events. Applications output log messages in a specific format to a file, then use a logging program to aggregate the logs for analysis. Mature solutions, such as <a href="https://www.elastic.co/elastic-stack/" target="_blank" rel="noopener noreferrer">ELK Stack</a> and <a href="https://grafana.com/oss/loki/" target="_blank" rel="noopener noreferrer">Grafana Loki</a>, are available on the market.</p><p>Despite being comprehensive and information-rich, log files eat up a lot of storage space. Although all the log events can be concatenated by timestamps, it is difficult to demonstrate their comprehensive mapping relationships.</p><p><strong>Metrics</strong></p><p>Metrics are mainly aggregated data measured over intervals of time. It is suited to measurable data, such as the number of calls, CPU, usage, and query size. Compared to logs, metrics take up much less storage space. Monitoring and alerting are the main uses of metrics, which Prometheus has established as the de facto standard.</p><p><strong>Traces</strong></p><p>A trace is a series of causally related distributed events, providing a wider and continuous view of an application. Tracing follows a program’s data progression path through a system. A trace contains one or more span(s), the logical unit of work named by <a href="https://www.jaegertracing.io/" target="_blank" rel="noopener noreferrer">Jaeger.</a> Each span includes the operation name, start time, and duration. Tracing adds critical visibility into the health of an application end-to-end, which is helpful for getting a better understanding of system behavior, debugging and troubleshooting issues related to performance.</p><p>Implement a monitoring system basically follows these steps: </p><ol><li>Setup event tracking </li><li>Output formatted logs</li><li>Collect metrics and logs</li><li>Display data in graphing interface</li><li>Establish response to early warnings</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="axons-monitoring-platform">Axon’s Monitoring Platform<a class="hash-link" href="#axons-monitoring-platform" title="Direct link to heading">​</a></h2><p>Axon&#x27;s monitoring platform contains Agent (Axon node), monitor server, and monitor dashboard. The diagram below illustrates these components and their interactions:</p><img loading="lazy" src="/img/devops/Figure 1 Overall design of Axon’s monitoring platform.png" class="img_ev3q"><p class="axon-anno">Figure 1. Overall design of Axon’s monitoring platform</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="agent-axon-node">Agent (Axon node)<a class="hash-link" href="#agent-axon-node" title="Direct link to heading">​</a></h3><p>Agent, or Axon node, is for collecting monitoring metrics and interacting with the monitor server.</p><ul><li><strong><a href="https://prometheus.io/docs/guides/node-exporter/" target="_blank" rel="noopener noreferrer">node-exporter</a></strong>: mainly collects system resource usage data from the target and converts it into a format supported by Prometheus located in the monitor server. Prometheus periodically scrapes metrics from the node exporter. This data will be visualized in Grafana.</li><li><strong>axon-exporter</strong>: mainly collects Axon’s metrics, which will be periodically scraped by Promethues and eventually be visualized in Grafana.</li><li><strong>jaeger-agent</strong>: listens and collects the traces data exposed by Axon and forwards them to the configured jaeger-collector.</li><li><strong>filebeat-agent</strong>: a lightweight shipper that collects, centralizes, and forwards log data to <a href="https://www.elastic.co/" target="_blank" rel="noopener noreferrer">elasticsearch</a>, a distributed search and analytics engine.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitor-server">Monitor Server<a class="hash-link" href="#monitor-server" title="Direct link to heading">​</a></h3><p>Monitor server is mainly for displaying the data of metrics and traces.</p><ul><li><strong>prometheus</strong>: collects Axon metrics which will be displayed as a datasource in Grafana.</li><li><strong>jaeger-collector</strong>: receives data pushed by jaeger-agent which will be displayed as a datasource in Grafana.</li><li><strong>elasticsearch</strong>: collects and stores Axon‘s logs, which will be displayed as a datasource in Grafana. Elasticsearch filters error logs and sends alerts through ES-alert (the alerting for Elasticsearch) in accordance with previously defined rules. (Please be aware that Elasticsearch may consume a lot of machine memory.)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitor-dashboard">Monitor Dashboard<a class="hash-link" href="#monitor-dashboard" title="Direct link to heading">​</a></h3><ul><li><strong>Grafana</strong>: uses Promethues, jaeger, and elasticsearch as datasources and displays data in dashboard, monitors, and logs.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-monitor-and-monitor-agent">Deploy Monitor and Monitor Agent<a class="hash-link" href="#deploy-monitor-and-monitor-agent" title="Direct link to heading">​</a></h2><p>Axon application performance monitoring (apm) supports one-click deployment of monitor and monitor agent.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitor-deployment">Monitor Deployment<a class="hash-link" href="#monitor-deployment" title="Direct link to heading">​</a></h3><p><strong>Step 1</strong> Copy <code>axon-devops</code> to the target machine.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/axonweb3/axon-devops</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> axon-devops/apm/monitor</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Step 2</strong> Edit <code>prometheus.yml</code> and <code>roles/monitor/vars/main.yml</code>. </p><p><strong><code>prometheus.yml</code></strong>: contains Prometheus configuration files. </p><p><code>scrape_config</code>, one of these files, specifies a set of targets and parameters describing how to scrape them. In the general case, one scrape configuration specifies a single <a href="https://prometheus.io/docs/concepts/jobs_instances/#jobs-and-instances" target="_blank" rel="noopener noreferrer">job</a>. </p><p>Below are a few <code>scrape_config</code> parameters set in Axon, and more configuration information is available <a href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/#scrape_config" target="_blank" rel="noopener noreferrer">here</a>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">global:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scrape_interval:     5s </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Scrape targets from a job every 15s. Default = 1m.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    evaluation_interval: 5s </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Evaluate rules every 15s. Default = 1m.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scrape_timeout:      5s </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Set to the global default (10s).</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>roles/monitor/vars/main.yml</code>: mainly used as the parameters required by <a href="https://www.ansible.com/" target="_blank" rel="noopener noreferrer">Ansible</a> when deploying the monitor. </p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">monitor_dir</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /home/ckb/axon</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">monitor</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Step 3</strong> Execute monitor deployment command.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> axon-devops/apm/deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> monitor-clean </span><span class="token comment" style="color:#999988;font-style:italic"># Stop monitor service（History data will be cleared. Use carefully）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> monitor-deploy </span><span class="token comment" style="color:#999988;font-style:italic"># Start monitor service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker-compose</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Check if service is seccessfully started.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitor-agent-deployment">Monitor Agent Deployment<a class="hash-link" href="#monitor-agent-deployment" title="Direct link to heading">​</a></h3><p><strong>Step 1</strong> Copy axon-devops directory to the target machine</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/axonweb3/axon-devops</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> axon-devops/apm/agent</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Step 2</strong> Edit config files.</p><ul><li><code>.env</code>: sets environment variables that are used when running the <code>docker-compose.yml</code></li></ul><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">JAEGER_COLLECTOR_IP=jaeger</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">14250</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Used to push data to the jaeger server.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Configure the ip port for jaeger-collector.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Corresponds to the jaeger-collector service in monitor docker-compose.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JAEGER_AGENT_PORT=6831 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Used to interact with Axon.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Associated with the [apm] tracing_address parameter.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AXON_LOG_PATH=axon/logs </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Used to collect logs for filebeat. </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Associated with the [logger] log_path parameter.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>jaeger_agent_port</code> config file is <a href="https://github.com/axonweb3/axon/blob/18aa176665159710d282c42394fa4506b8b5755e/devtools/chain/config.toml#L68" target="_blank" rel="noopener noreferrer">here</a>. </p><ul><li><code>filebeat.yml</code>: used to build structured configurations for lists and dictionaries</li></ul><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">filebeat.inputs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">paths</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/usr/share/filebeat/logs/*log&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Filebeat collects files in /usr/share/filebeat/logs/ that end in .log</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">fields_under_root</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Custom fields will be stored as top-level fields in the output file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">keys_under_root</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># The existing keys are overwritten by keys in decoded JSON obejct</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ignore_older</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 5m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Filebeat will ingore files modified before the specified time span</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">scan_frequency</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 1s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># How frequently Filebeat checks new files in the path specified for files collection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">output.elasticsearch</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># filebeat sends logs to elasticsearch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">hosts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;ES_ADDRESS:9200&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># elasticsearch host</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">indices</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">index</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;axon-%{[agent.version]}-%{+yyyy.MM.dd}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># Index for creating datasource in Grafaba. Logs can be located with axon-*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>axon-devops/apm/deploy/roles/agent/vars/main.yaml</code></li></ul><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">monitor_agent_dir</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /home/ckb/axon</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">apm</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">agent </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Copy the command to the target file storage section</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">log_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> \/home\/ckb\/axon\/logs </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Axon&#x27;s Logs directory. Must be identical with Axon deployment directory. </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">es_address</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> XXX.XX.XX.XX </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Intranet of the ip address deployed by elasticsearch.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>axon-devops/apm/deploy/hosts</li></ul><div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Configure monitor agent deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[axon_node] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Monitor agent deployment follows axon agent. Here axon node ip must be specified.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XXX.XXX.XXX.XXX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[prometheus_server]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># prometheus_server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xxx.xxx.xxx.xxx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[allhost:children]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">axon_node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prometheus_server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Step 3</strong> Execute Monitor Agent deployment command</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> axon-devops/apm/deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> clean </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Clear axon monitor agent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> deploy </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Deploy axon monitor agent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker-compose</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check if service is successfully started.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="view-monitoring-platform">View Monitoring Platform<a class="hash-link" href="#view-monitoring-platform" title="Direct link to heading">​</a></h3><p>When all services are up, you can access the corresponding monitoring platforms through the browser by the following address:</p><ul><li>Grafana</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http://grafana_ip:3000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Jaeger </li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http://jarger_ip:16686</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-high-availability-monitoring">Deploy High Availability Monitoring<a class="hash-link" href="#deploy-high-availability-monitoring" title="Direct link to heading">​</a></h3><p>High Availability (HA) monitoring is also supported. However, due to the high cost of operation and maintenance, Axon does not use HA but a single-node deployment (as explained in Section II) instead.</p><p>If your monitoring platform is suitable for HA, you can refer to the following tutorials:</p><ul><li>Grafana: <a href="https://grafana.com/docs/grafana/v9.0/setup-grafana/set-up-for-high-availability/" target="_blank" rel="noopener noreferrer">Set up Grafana for high availability</a></li><li>Promethues: <a href="https://prometheus.io/docs/prometheus/latest/federation/" target="_blank" rel="noopener noreferrer">Federation HA mode</a></li><li>Promethues: <a href="https://prometheus.io/docs/prometheus/latest/storage/" target="_blank" rel="noopener noreferrer">Storage HA mode</a></li><li>Elasticsearch: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.1/next-getting-started-tls-docker.html" target="_blank" rel="noopener noreferrer">Multi-node cluster HA mode</a></li><li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.1/next-getting-started-tls-docker.html" target="_blank" rel="noopener noreferrer">Multi-node Elasticsearch cluster</a><ul><li>For retention requirements, refer to the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.5/index-lifecycle-management.html#index-lifecycle-management" target="_blank" rel="noopener noreferrer">index-lifecycle-management</a> section in the documentation.</li></ul></li><li>Jaeger HA mode<ul><li>Jaeger components can exist independently and communicate via RPC. It is recommended to deploy multiple jaeger-collectors for collecting in HA mode.</li><li>It is recommended to deploy multiple jaeger-query nodes as well and add <a href="https://www.nginx.com/" target="_blank" rel="noopener noreferrer">Nginx</a> for query in HA mode.</li><li>Data can be cleaned up periodically in accordance with the storage. Take Elasticsearch as an example, to perform a deletion you can refer to the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.6/docs-delete-by-query.html" target="_blank" rel="noopener noreferrer">Delete by Query API tutorial</a> or the official <a href="https://github.com/elastic/curator" target="_blank" rel="noopener noreferrer">Curator Project</a></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-metrics-explained">Monitoring Metrics Explained<a class="hash-link" href="#monitoring-metrics-explained" title="Direct link to heading">​</a></h2><p>This section provides an overview of the monitoring metrics on each Grafana panel.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="axon-node">Axon-node<a class="hash-link" href="#axon-node" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="recource-overview">Recource Overview<a class="hash-link" href="#recource-overview" title="Direct link to heading">​</a></h4><img loading="lazy" src="/img/devops/Server Resource Overview w:marks.png" class="img_ev3q"><p class="axon-anno">Figure 2. Server Resource Overview</p><table><thead><tr><th></th><th>Metrics Brower</th><th>Type</th><th>Description</th><th>Legend Details</th></tr></thead><tbody><tr><td>1</td><td><strong>Overall total 5m load &amp; average CPU used</strong></td><td>CPU</td><td>Monitor overall cpu usage</td><td><strong>CPU Cores</strong> Number of cores for all CPUs <code>count(node_cpu_seconds_total{job=~&quot;node_exporter&quot;, mode=&#x27;system&#x27;})</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Total 5m load</strong> Load5 for all CPUs <code>sum(node_load5{job=~&quot;node_exporter&quot;})</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Overall average used%</strong> Average utilization of all CPUs <code>avg(1 - avg(irate(node_cpu_seconds_total{job=~&quot;node_exporter&quot;,mode=&quot;idle&quot;}[5m])) by (instance)) * 100</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Load5 Avg</strong> Load5 Avg for all CPUs <code>sum(node_load5{job=~&quot;node_exporter&quot;}) / count(node_cpu_seconds_total{job=~&quot;node_exporter&quot;, mode=&#x27;system&#x27;})</code></td></tr><tr><td>2</td><td><strong>Overall total memory &amp; average memory used</strong></td><td>Disk</td><td>Monitor overall disk usage</td><td><strong>Total</strong> Total memory <code>sum(node_memory_MemTotal_bytes{job=~&quot;node_exporter&quot;})</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Total Used</strong> Overall used memory <code>sum(node_memory_MemTotal_bytes{job=~&quot;node_exporter&quot;} - node_memory_MemAvailable_bytes{job=~&quot;node_exporter&quot;})</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Total Average Used</strong> Utilization of all memory <code>(sum(node_memory_MemTotal_bytes{job=~&quot;node_exporter&quot;} - node_memory_MemAvailable_bytes{job=~&quot;node_exporter&quot;}) / sum(node_memory_MemTotal_bytes{job=~&quot;node_exporter&quot;}))*100</code></td></tr><tr><td>3</td><td><strong>Overall total disk &amp; average disk used%</strong></td><td>Disk</td><td>Monitor overall disk usage</td><td><strong>Total</strong> Total memory <code>sum(avg(node_filesystem_size_bytes{job=\~&quot;node_exporter&quot;,fstype=\~&quot;xfs\|ext.*&quot;})by(device,instance))</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Total Used</strong> Overall used disk <code>sum(avg(node_filesystem_size_bytes{job=\~&quot;node_exporter&quot;,fstype=\~&quot;xfs\|ext.*&quot;})by(device,instance)) -sum(avg(node_filesystem_free_bytes{job=\~&quot;node_exporter&quot;,fstype=\~&quot;xfs\|ext.*&quot;})by(device,instance))</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Total Average Used%</strong> Utilization of all disk <code>(sum(avg(node_filesystem_size_bytes{job=\~&quot;node_exporter&quot;,fstype=\~&quot;xfs\|ext.*&quot;})by(device,instance)) - sum(avg(node_filesystem_free_bytes{job=\~&quot;node_exporter&quot;,fstype=\~&quot;xfs\|ext.*&quot;})by(device,instance))) *100/(sum(avg(node_filesystem_avail_bytes{job=\~&quot;node_exporter&quot;,fstype=\~&quot;xfs\|ext.*&quot;})by(device,instance))+(sum(avg(node_filesystem_size_bytes{job=\~&quot;node_exporter&quot;,fstype=\~&quot;xfs\|ext.*&quot;})by(device,instance)) - sum(avg(node_filesystem_free_bytes{job=\~&quot;node_exporter&quot;,fstype=\~&quot;xfs\|ext.*&quot;})by(device,instance))))</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="resource-details">Resource Details<a class="hash-link" href="#resource-details" title="Direct link to heading">​</a></h4><img loading="lazy" src="/img/devops/Figure 3 Resource details w: marks.png" class="img_ev3q"><p class="axon-anno">Figure 3. Resource details</p><table><thead><tr><th></th><th>Name</th><th>Type</th><th>Description</th><th>Legend Details</th></tr></thead><tbody><tr><td>1</td><td><strong>Internet traffic per hour</strong></td><td>Network</td><td>Traffic statistics</td><td><strong>Receive</strong> <code>Receive statistics increase(node_network_receive_bytes_total{instance=~&quot;$node&quot;,device=~&quot;$device&quot;}[60m])</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Transmit</strong> transmit statistics <code>increase(node_network_transmit_bytes_total{instance=~&quot;$node&quot;,device=~&quot;$device&quot;}[60m])</code></td></tr><tr><td>2</td><td><strong>CPU% Basic</strong></td><td>CPU</td><td>Traffic statistics</td><td><strong>System</strong> <code>Average sy ratio avg(irate(node_cpu_seconds_total{instance=~&quot;$node&quot;,mode=&quot;system&quot;}[5m])) by (instance) *100</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>User</strong> <code>Average sy ratio avg(irate(node_cpu_seconds_total{instance=~&quot;$node&quot;,mode=&quot;user&quot;}[5m])) by (instance) *100</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Iowait</strong> <code>Average sy ratio avg(irate(node_cpu_seconds_total{instance=~&quot;$node&quot;,mode=&quot;iowait&quot;}[5m])) by (instance) *100</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Total</strong> Average CPU usage <code>(1 - avg(irate(node_cpu_seconds_total{instance=~&quot;$node&quot;,mode=&quot;idle&quot;}[5m])) by (instance))*100</code></td></tr><tr><td>3</td><td><strong>Memory Basic</strong></td><td>Memory</td><td>Node memory usage</td><td><strong>Total</strong> Total memory <code>node_memory_MemTotal_bytes{instance=~&quot;$node&quot;}</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Used</strong> Used memory <code>node_memory_MemTotal_bytes{instance=~&quot;$node&quot;} - node_memory_MemAvailable_bytes{instance=~&quot;$node&quot;}</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Available</strong> Available memory size <code>node_memory_MemAvailable_bytes{instance=~&quot;$node&quot;}</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Used%</strong> Utilization of all memory <code>(1 - (node_memory_MemAvailable_bytes{instance=~&quot;$node&quot;} / (node_memory_MemTotal_bytes{instance=~&quot;$node&quot;})))* 100</code></td></tr><tr><td>4</td><td><strong>Network bandwidth usage per second all</strong></td><td>Network</td><td>Network bandwidth</td><td><strong>ReceiveTotal</strong> Receive statistics per second <code>irate(node_network_receive_bytes_total{instance=~&#x27;$node&#x27;,device=~&quot;$device&quot;}[5m])*8</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Transmit</strong> Transmit statistics per second <code>irate(node_network_transmit_bytes_total{instance=~&#x27;$node&#x27;,device=~&quot;$device&quot;}[5m])*8</code></td></tr><tr><td>5</td><td><strong>System Load</strong></td><td>CPU</td><td>System Load</td><td><strong>1m</strong> Load 1 <code>node_load1{instance=~&quot;$node&quot;}</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>5m</strong> Load 5 <code>node_load5{instance=~&quot;$node&quot;}</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>15m</strong> Load 15 <code>node_load15{instance=~&quot;$node&quot;}</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>CPU cores</strong> Number of cores for CPU <code>sum(count(node_cpu_seconds_total{instance=~&quot;$node&quot;, mode=&#x27;system&#x27;}) by (cpu,instance)) by(instance)</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Load5 Avg</strong> load5 Avg for CPU <code>avg(node_load5{instance=~&quot;$node&quot;}) / count(node_cpu_seconds_total{instance=~&quot;$node&quot;, mode=&#x27;system&#x27;})</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Load5 Avg-{{instance}}</strong> Not shown, for alert <code>sum(node_load5) by (instance) / count(node_cpu_seconds_total{job=~&quot;node_exporter&quot;, mode=&#x27;system&#x27;}) by (instance)</code></td></tr><tr><td>6</td><td><strong>Disk R/W Data</strong></td><td>Disk</td><td>Disk thoughput</td><td><strong>Read bytes</strong> <code>node_load1{instance=~&quot;$node&quot;}</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Written bytes</strong> <code>node_load5{instance=~&quot;$node&quot;}</code></td></tr><tr><td>7</td><td><strong>Disk Space Used% Basic</strong></td><td>Disk</td><td>IOPS</td><td><strong>Mount point</strong> Disk space utilization `(node_filesystem_size_bytes{instance=~&#x27;$node&#x27;,fstype=~&quot;ext.*</td></tr><tr><td>8</td><td><strong>Disk IOps Completed (IOPS)</strong></td><td>Disk</td><td>IOPS</td><td><strong>Reads completed</strong> Read IOPS <code>irate(node_disk_io_time_seconds_total{instance=~&quot;$node&quot;}[5m])</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Writes completed</strong> Write IOPS <code>irate(node_disk_io_time_seconds_total{instance=~&quot;(.*):9100&quot;}[5m])</code></td></tr><tr><td>9</td><td><strong>Time Spent Doing I/Os</strong></td><td>Disk</td><td>I/O Utilization</td><td><strong>IO time</strong> I/O Utilization <code>irate(node_disk_io_time_seconds_total{instance=~&quot;$node&quot;}[5m])</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>{{instance}}-%util</strong> Not shown, for alert <code>irate(node_disk_io_time_seconds_total{instance=~&quot;(.*):9100&quot;}[5m]</code>)</td></tr><tr><td>10</td><td><strong>Disk R/W Time(Reference: less than 100ms)(beta)</strong></td><td>Disk</td><td>Average response time</td><td><strong>Read time</strong> <code>irate(node_disk_read_time_seconds_total{instance=~&quot;$node&quot;}[5m]) / irate(node_disk_reads_completed_total{instance=~&quot;$node&quot;}[5m])</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Write time</strong> <code>irate(node_disk_write_time_seconds_total{instance=~&quot;$node&quot;}[5m]) / irate(node_disk_writes_completed_total{instance=~&quot;$node&quot;}[5m]</code>)</td></tr><tr><td>11</td><td><strong>Network Sockstat</strong></td><td>Network</td><td>Socketstat</td><td><strong>CurrEstab</strong> Number of ESTABLISHED state connections <code>node_netstat_Tcp_CurrEstab{instance=~&#x27;$node&#x27;}</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>TCP_tw status</strong> Number of time_wait state connections <code>node_sockstat_TCP_tw{instance=~&#x27;$node&#x27;}</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Sockets_used</strong> Total number of all protocol sockets used <code>node_sockstat_sockets_used{instance=~&#x27;$node&#x27;}</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>UDP_inuse</strong> Number of UDP sockets in use <code>node_sockstat_UDP_inuse{instance=~&#x27;$node&#x27;}</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>TCP_alloc</strong> Number of tcp sockets(ESTABLISHED, sk_buff) <code>Number of TCP sockets(ESTABLISHED, sk_buff)</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Tcp_PassiveOpens</strong> Number of passively opened tcp connections <code>irate(node_netstat_Tcp_PassiveOpens{instance=~&#x27;$node&#x27;}[5m])</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Tcp_ActiveOpens</strong> Number of active open tcp connections <code>irate(node_netstat_Tcp_ActiveOpens{instance=~&#x27;$node&#x27;}[5m])</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Tcp_InSegs</strong> Number of tcp messages received <code>irate(node_netstat_Tcp_InSegs{instance=~&#x27;$node&#x27;}[5m])</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Tcp_OutSegs</strong> Number of tcp messages transmit <code>irate(node_netstat_Tcp_OutSegs{instance=~&#x27;$node&#x27;}[5m])</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Tcp_RetransSegs</strong> Number of tcp messages retransmitted <code>irate(node_netstat_Tcp_RetransSegs{instance=~&#x27;$node&#x27;}[5m])</code></td></tr><tr><td>12</td><td><strong>Open File Descriptor (left)/Context switches (right)</strong></td><td>Disk</td><td>I/O Utilization</td><td><strong>Used filefd</strong> Number of open file fd <code>node_filefd_allocated{instance=~&quot;$node&quot;</code></td></tr><tr><td></td><td></td><td></td><td></td><td><strong>Switches</strong> Context switches <code>irate(node_context_switches_total{instance=~&quot;$node&quot;}[5m])</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="actuator-health">Actuator Health<a class="hash-link" href="#actuator-health" title="Direct link to heading">​</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Legend Details</th></tr></thead><tbody><tr><td>Axon Status</td><td>Axon</td><td>Axon service status</td><td><strong>active</strong> Number of Axon service in up status <code>count(up{job=&quot;axon_exporter&quot;} == 1)</code></td></tr><tr><td></td><td></td><td></td><td><strong>down</strong> Number of Axon service in down status <code>(up{job=&quot;axon_exporter&quot;} == 0)</code></td></tr><tr><td>Node status</td><td>Node_exporter</td><td>Node_exporter service status</td><td><strong>active</strong> Number of Node_exporter services in up status <code>count(up{job=&quot;node_exporter&quot;} == 1)</code></td></tr><tr><td></td><td></td><td></td><td><strong>down</strong> Number of Node_exporter services in down status <code>count(up{job=&quot;node_exporter&quot;} == 0)</code></td></tr><tr><td>Promethues Status</td><td>Promethues</td><td>Promethues service status</td><td><strong>active</strong> Number of Promethues services in up status <code>count(up{job=&quot;prometheus&quot;} == 1)</code></td></tr><tr><td></td><td></td><td></td><td><strong>down</strong> Number of Promethues services in down status <code>count(up{job=&quot;prometheus&quot;} == 0)</code></td></tr><tr><td>Jaeger status</td><td>Jaeger</td><td>Jaeger service status</td><td><strong>jaeger-query-active</strong> Number of Jaeger-query services in up status <code>count(up{instance=~&quot;(.*):16687&quot;} == 1)</code></td></tr><tr><td></td><td></td><td></td><td><strong>jaeger-collector-active</strong> Number of Jaeger-collector services in down status <code>count(up{instance=~&quot;(.*):14269&quot;} == 1)</code></td></tr><tr><td></td><td></td><td></td><td><strong>jaeger-query-down</strong> Number of Jaeger-query services in up status <code>count(up{instance=~&quot;(.*):16687&quot;} == 0)</code></td></tr><tr><td></td><td></td><td></td><td><strong>jaeger-collector-down</strong> Number of Jaeger-collector services in down status <code>count(up{instance=~&quot;(.*):14269&quot;} == 0)</code></td></tr><tr><td>Jaeger Agent Status</td><td>Jaeger</td><td>Jaeger agent status</td><td><strong>active</strong> Number of Jaeger-agent services in up status <code>count(up{job=&quot;jaeger_agent&quot;} == 1)</code></td></tr><tr><td></td><td></td><td></td><td><strong>down</strong> Number of Jaeger-agent services in down status <code>count(up{job=&quot;jaeger_agent&quot;} == 0)</code></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="axon-benchmark">Axon-benchmark<a class="hash-link" href="#axon-benchmark" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="panel-1">Panel 1<a class="hash-link" href="#panel-1" title="Direct link to heading">​</a></h4><img loading="lazy" src="/img/devops/Panel 1 w: marks.png" class="img_ev3q"><p class="axon-anno">Figure 4. Panel 1</p><table><thead><tr><th></th><th>Name</th><th>Description</th><th>Legend Details</th></tr></thead><tbody><tr><td>1</td><td>TPS</td><td>TPS for consensus</td><td><code>avg(rate(axon_consensus_committed_tx_total[5m]))</code></td></tr><tr><td>2</td><td>exec_90</td><td>Consensus exec time for P90</td><td><code>avg(histogram_quantile(0.90, sum(rate(axon_consensus_time_cost_seconds_bucket{type=&quot;exec&quot;}[5m])) by (le, instance)))</code></td></tr><tr><td>3</td><td>consensus_round_cost</td><td>Number of rounds needed to reach consensus</td><td><strong>{{instance}}</strong> Number of rounds needed to reach consensus <code>(axon_consensus_round &gt; 0 )</code></td></tr><tr><td>4</td><td>consensus_90</td><td>Consensus time for P90</td><td><strong>time_usage(s)</strong> Consensus time for P90 <code>avg(histogram_quantile(0.90, sum(rate(axon_consensus_duration_seconds_bucket[5m])) by (le, instance)))</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="panel-2">Panel 2<a class="hash-link" href="#panel-2" title="Direct link to heading">​</a></h4><img loading="lazy" src="/img/devops/Panel 2 w: marks.png" class="img_ev3q"><p class="axon-anno">Figure 5. Panel 2</p><table><thead><tr><th></th><th>Name</th><th>Description</th><th>Legend Details</th></tr></thead><tbody><tr><td>1</td><td>get_cf_each_block_time_usage</td><td>Average time per block for rocksdb running get_cf</td><td>Average time per block for rocksdb running get_cf <code>avg (sum by (instance) (increase(axon_storage_get_cf_seconds[5m]))) / avg(increase(axon_consensus_height[5m]))</code></td></tr><tr><td>2</td><td>put_cf_each_block_time_usage</td><td>Average time per block for rocksdb running put_cf</td><td>Average time per block for rocksdb running put_cf <code>avg (sum by (instance) (increase(axon_storage_put_cf_seconds[5m]))) / avg(increase(axon_consensus_height[5m]))</code></td></tr><tr><td>3</td><td>current_height</td><td>Chain current height</td><td><strong>{{instance}}</strong> Node current height <code>sort_desc(axon_consensus_height)</code></td></tr><tr><td>4</td><td>check_block_cost_p90</td><td>check block exec time for P90</td><td>Check block exec time for P90 <code>avg(histogram_quantile(0.90, sum(rate(axon_consensus_check_block_bucket{type=&quot;get_txs_cost&quot;}[5m])) by (le, instance)))</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="panel-3">Panel 3<a class="hash-link" href="#panel-3" title="Direct link to heading">​</a></h4><img loading="lazy" src="/img/devops/Panel 3 w: marks.png" class="img_ev3q"><p class="axon-anno">Figure 6. Panel 3</p><table><thead><tr><th></th><th>Name</th><th>Description</th><th>Legend Details</th></tr></thead><tbody><tr><td>1</td><td>synced_block</td><td>Number of blocks synchronized by nodes</td><td><strong>{{instance}}</strong> Number of blocks synchronized by nodes <code>axon_consensus_sync_block_total</code></td></tr><tr><td>2</td><td>liveness</td><td>Liveness</td><td>Growth in node height <code>increase(axon_consensus_height{job=&quot;axon_exporter&quot;}[1m])</code></td></tr><tr><td>3</td><td>mempool_cached_tx</td><td>Number of transactions in the current mempool</td><td><strong>{{instance}}</strong> Number of transactions in the current mempool <code>axon_mempool_tx_count</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="panel-4">Panel 4<a class="hash-link" href="#panel-4" title="Direct link to heading">​</a></h4><img loading="lazy" src="/img/devops/Panel 4 w: marks.png" class="img_ev3q"><p class="axon-anno">Figure 7. Panel 4</p><table><thead><tr><th></th><th>Name</th><th>Description</th><th>Legend Details</th></tr></thead><tbody><tr><td>1</td><td>processed_tx_request</td><td>received transaction request count in last 5 minutes (the unit is count/second)</td><td><strong>Total</strong> Total number of transaction requests <code>sum(rate(axon_api_request_result_total{type=&quot;send_transaction&quot;}[5m]))</code></td></tr><tr><td></td><td></td><td></td><td><strong>Success Total</strong> Total number of successful transaction requests <code>sum(rate(axon_api_request_result_total{result=&quot;success&quot;,type=&quot;send_transaction&quot;}[5m]))</code></td></tr><tr><td></td><td></td><td></td><td><strong>instance</strong> processed transaction request count in last 5 minutes (the unit is count/second) <code>rate(axon_api_request_result_total{result=&quot;success&quot;, type=&quot;send_transaction&quot;}[5m])</code></td></tr><tr><td>2</td><td>processed_rpc_request</td><td>Estimate total number of  of successful  API request  in last five minutes</td><td><strong>Success Total</strong> Total number of successful API requests <code>sum(rate(axon_api_request_result_total{result=&quot;success&quot;}[5m])) by (type)</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="other-items">Other Items<a class="hash-link" href="#other-items" title="Direct link to heading">​</a></h4><table><thead><tr><th>Name</th><th>Description</th><th>Legend Details</th></tr></thead><tbody><tr><td>network_message_arrival_rate</td><td>Estimate the network message arrival rate in the last five minutes</td><td>Estimate the network message arrival rate in the last five minutes <code>(  # broadcast_count * (instance_count - 1)  sum(increase(axon_network_message_total{target=&quot;all&quot;, direction=&quot;sent&quot;}[5m])) * (count(count by (instance) (axon_network_message_total)) - 1)  # unicast_count  + sum(increase(axon_network_message_total{target=&quot;single&quot;, direction=&quot;sent&quot;}[5m]))) /# received_count(sum(increase(axon_network_message_total{direction=&quot;received&quot;}[5m]))) </code></td></tr><tr><td>consensus_round_cost</td><td>Number of rounds needed to reach consensus</td><td><strong>{{instance}}</strong> Number of rounds needed to reach consensus <code>(axon_consensus_round &gt; 0 )</code></td></tr><tr><td>Connected Peers(Gauge)</td><td>Number of nodes on the current connection</td><td><strong>{{instance}}</strong> Number of nodes on the current connection <code>axon_network_connected_peers</code></td></tr><tr><td>Connected Peers(Graph)</td><td>Number of nodes on the current connection</td><td><strong>Saved peers</strong> Total number of peers <code>max(axon_network_saved_peer_count)</code></td></tr><tr><td></td><td></td><td><strong>Connected Peers</strong> Number of nodes on the current connection <code>axon_network_connected_peers</code></td></tr><tr><td>Consensus Peers(Gauge)</td><td>Number of consensus nodes</td><td><strong>{{instance}}</strong> Number of consensus nodes <code>axon_network_tagged_consensus_peers</code></td></tr><tr><td>Consensus Peers(Graph)</td><td>Number of consensus nodes</td><td><strong>Consensus peers</strong> Total number of consensus peers <code>max(axon_network_tagged_consensus_peers)</code></td></tr><tr><td></td><td></td><td><strong>{{instance}}-Connected Consensus Peers (Minus itself)</strong> Number of consensus nodes <code>axon_network_connected_consensus_peers</code></td></tr><tr><td>Saved peers</td><td>Number of nodes saved peers</td><td><strong>{{instance}}</strong> Number of nodes saved peers <code>axon_network_saved_peer_count</code></td></tr><tr><td>Unidentified Connections</td><td>The number of connections in the handshake, requiring verification of the chain</td><td><strong>{{instance}}</strong> The number of connections in the handshake, requiring verification of the chain id <code>axon_networ_unidentified_connections</code></td></tr><tr><td>Connecting Peers</td><td>Number of active initiations to establish connections with other</td><td><strong>{{instance}}</strong> Number of active initiations to establish connections with other machines <code>axon_network_outbound_connecting_peers</code></td></tr><tr><td>Disconnected count (To other peers)</td><td>Disconnected count</td><td><strong>{{instance}}</strong> Disconnected count <code>axon_network_ip_disconnected_count</code></td></tr><tr><td>Received messages in processing</td><td>Number of messages being processed</td><td><strong>{{instance}}</strong> Number of messages being processed <code>axon_network_received_message_in_processing_guage</code></td></tr><tr><td>Received messages in processing by ip</td><td>Number of messages being processed (based on IP of received messages)</td><td><strong>{{instance}}</strong> Number of messages being processed (based on IP of received messages) <code>axon_network_received_ip_message_in_processing_guage{instance=~&quot;$node&quot;} </code></td></tr><tr><td>Ping (ms)_ p90</td><td>p90 for p2p Ping</td><td><strong>{{instance}}</strong> p90 for P2p Ping <code>avg(histogram_quantile(0.90, sum(rate(axon_network_ping_in_ms_bucket[5m])) by (le, instance)))</code></td></tr><tr><td>Network bandwidth usage per second all</td><td>link to axon-node (Network bandwidth usage per second all)</td><td>link to axon-node (Network bandwidth usage per second all)</td></tr><tr><td>Internet traffic per hour</td><td>link to axon-node (Internet traffic per hour)</td><td>link axon-benchmark (internet traffic per hour)</td></tr><tr><td>mempool_cached_tx</td><td>link axon-benchmark (mempool_cached_tx)</td><td>link axon-benchmark (mempool_cached_tx)</td></tr><tr><td>consensus_round_cost</td><td>link axon-benchmark (consensus_round_cost)</td><td>link axon-benchmark (consensus_round_cost)</td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/axonweb3/axon-docs/edit/main/docs/devops/monitoring-platform.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-03-15T05:45:21.000Z">Mar 15, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/category/devops"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">DevOps</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/devops/explorer"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Explorer</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#black-box-monitoring-system-and-observability" class="table-of-contents__link toc-highlight">Black box, monitoring system, and observability</a></li><li><a href="#axons-monitoring-platform" class="table-of-contents__link toc-highlight">Axon’s Monitoring Platform</a><ul><li><a href="#agent-axon-node" class="table-of-contents__link toc-highlight">Agent (Axon node)</a></li><li><a href="#monitor-server" class="table-of-contents__link toc-highlight">Monitor Server</a></li><li><a href="#monitor-dashboard" class="table-of-contents__link toc-highlight">Monitor Dashboard</a></li></ul></li><li><a href="#deploy-monitor-and-monitor-agent" class="table-of-contents__link toc-highlight">Deploy Monitor and Monitor Agent</a><ul><li><a href="#monitor-deployment" class="table-of-contents__link toc-highlight">Monitor Deployment</a></li><li><a href="#monitor-agent-deployment" class="table-of-contents__link toc-highlight">Monitor Agent Deployment</a></li><li><a href="#view-monitoring-platform" class="table-of-contents__link toc-highlight">View Monitoring Platform</a></li><li><a href="#deploy-high-availability-monitoring" class="table-of-contents__link toc-highlight">Deploy High Availability Monitoring</a></li></ul></li><li><a href="#monitoring-metrics-explained" class="table-of-contents__link toc-highlight">Monitoring Metrics Explained</a><ul><li><a href="#axon-node" class="table-of-contents__link toc-highlight">Axon-node</a></li><li><a href="#axon-benchmark" class="table-of-contents__link toc-highlight">Axon-benchmark</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                <img id="footer-logo" src="/img/logo_light.png" alt="Axon">
                <a href="mailto:axon@axonweb3.io">axon@axonweb3.io</a>
                </li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><div id="footer-links-placeholder">
                </div></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">This website is maintained by AxonWeb3.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.af764483.js"></script>
<script src="/assets/js/main.efb38284.js"></script>
</body>
</html>